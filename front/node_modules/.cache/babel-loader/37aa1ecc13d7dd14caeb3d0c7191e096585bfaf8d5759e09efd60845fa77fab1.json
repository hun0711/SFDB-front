{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/carax/Desktop/SideProject/SFDB-Project/front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/carax/Desktop/SideProject/SFDB-Project/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/carax/Desktop/SideProject/SFDB-Project/front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{gapi}from'gapi-script';import{googleSocialLogin,googleUserInfo}from'../../axios/user/loginLogic';import config from'../../config';import{serialize}from'cookie';import{useNavigate}from'react-router';import{Alert,Snackbar}from'@mui/material';import{useSnackbar}from'notistack';import{getCookie}from'../../utils/getCookies';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var GoogleLogin=function GoogleLogin(){var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),alertOn=_useState2[0],setAlertOn=_useState2[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var handleClose=function handleClose(){setAlertOn(false);};{/* 구글 sdk */}useEffect(function(){var loadGoogleApiScript=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return new Promise(function(resolve,reject){var script=document.createElement('script');script.src='https://apis.google.com/js/api.js';script.onload=resolve;script.onerror=reject;document.body.appendChild(script);});case 3:_context.next=8;break;case 5:_context.prev=5;_context.t0=_context[\"catch\"](0);console.error('Google API 스크립트 로드 실패:',_context.t0);case 8:case\"end\":return _context.stop();}},_callee,null,[[0,5]]);}));return function loadGoogleApiScript(){return _ref.apply(this,arguments);};}();loadGoogleApiScript();},[]);{/*  구글 로그인 처리 함수 */}var handleGoogleLogin=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var auth2,googleUser,googleAccessToken,googleLoginData,res,userName;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;if(gapi.auth2){_context2.next=4;break;}_context2.next=4;return new Promise(function(resolve){gapi.load('auth2',resolve);});case 4:// 'gapi.auth2'가 초기화되지 않았다면 초기화\nif(!gapi.auth2.getAuthInstance()){gapi.auth2.init({client_id:config.googleClientId,cookie_policy:'single_host_origin',scope:'profile email'});}auth2=gapi.auth2.getAuthInstance();_context2.next=8;return auth2.signIn();case 8:googleUser=_context2.sent;googleAccessToken=googleUser.getAuthResponse().access_token;console.log('Google Access Token:',googleAccessToken);_context2.next=13;return googleUserInfo(googleAccessToken);case 13:googleLoginData=_context2.sent;_context2.next=16;return googleSocialLogin(googleLoginData);case 16:res=_context2.sent;// 스프링 백엔드의 구글 로그인 API 엔드포인트로 대체\nconsole.log('Google 로그인 결과:',res);if(res===1){document.cookie=serialize('userId',googleLoginData.id,{path:'/'});document.cookie=serialize('userEmail',googleLoginData.email,{path:'/'});document.cookie=serialize('userName',googleLoginData.name,{path:'/'});document.cookie=serialize('userProfileImage',googleLoginData.picture,{path:'/'});navigate('/main');userName=getCookie('userName');enqueueSnackbar(\"\".concat(userName,\"\\uB2D8, \\uC5B4\\uC11C\\uC624\\uC138\\uC694.\"),{variant:'success'});setAlertOn(true);}else{console.log('Google 로그인 실패');enqueueSnackbar('로그인에 실패했습니다.',{variant:'warning'});setAlertOn(true);}_context2.next=26;break;case 21:_context2.prev=21;_context2.t0=_context2[\"catch\"](0);console.error('Google 로그인 에러:',_context2.t0);enqueueSnackbar('네트워크 오류 발생!',{variant:'error'});setAlertOn(true);case 26:case\"end\":return _context2.stop();}},_callee2,null,[[0,21]]);}));return function handleGoogleLogin(){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center'},children:/*#__PURE__*/_jsx(\"img\",{src:\"/images/logo/googlebtn2.png\",alt:\"\\uAD6C\\uAE00 \\uB85C\\uADF8\\uC778\",style:{width:'220px',height:'50px',cursor:'pointer'},onClick:handleGoogleLogin})}),/*#__PURE__*/_jsx(Snackbar,{open:alertOn,autoHideDuration:3000,onClose:handleClose,children:/*#__PURE__*/_jsx(Alert,{onClose:handleClose,severity:\"success\",sx:{width:'100%'},children:\"\\uB85C\\uADF8\\uC778\\uC5D0 \\uC131\\uACF5\\uD588\\uC2B5\\uB2C8\\uB2E4!\"})})]});};export default GoogleLogin;","map":{"version":3,"names":["React","useEffect","useState","gapi","googleSocialLogin","googleUserInfo","config","serialize","useNavigate","Alert","Snackbar","useSnackbar","getCookie","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","GoogleLogin","navigate","_useState","_useState2","_slicedToArray","alertOn","setAlertOn","_useSnackbar","enqueueSnackbar","handleClose","loadGoogleApiScript","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","Promise","resolve","reject","script","document","createElement","src","onload","onerror","body","appendChild","t0","console","error","stop","apply","arguments","handleGoogleLogin","_ref2","_callee2","auth2","googleUser","googleAccessToken","googleLoginData","res","userName","_callee2$","_context2","load","getAuthInstance","init","client_id","googleClientId","cookie_policy","scope","signIn","sent","getAuthResponse","access_token","log","cookie","id","path","email","name","picture","concat","variant","children","style","textAlign","alt","width","height","cursor","onClick","open","autoHideDuration","onClose","severity","sx"],"sources":["C:/Users/carax/Desktop/SideProject/SFDB-Project/front/src/pages/user/GoogleLogin.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { gapi } from 'gapi-script';\r\nimport { googleSocialLogin, googleUserInfo } from '../../axios/user/loginLogic';\r\nimport config from '../../config';\r\nimport { serialize } from 'cookie';\r\nimport { useNavigate } from 'react-router';\r\nimport { Alert, Snackbar } from '@mui/material';\r\nimport { useSnackbar } from 'notistack';\r\nimport { getCookie } from '../../utils/getCookies';\r\n\r\n\r\nconst GoogleLogin = () => {\r\n  const navigate = useNavigate()\r\n  const [alertOn, setAlertOn] = useState(false);\r\n  const { enqueueSnackbar } = useSnackbar(); \r\n  \r\n  const handleClose = () => {\r\n    setAlertOn(false)\r\n  }\r\n\r\n\r\n{/* 구글 sdk */}\r\nuseEffect(() => {\r\n  const loadGoogleApiScript = async () => {\r\n    try {\r\n      await new Promise((resolve, reject) => {\r\n        const script = document.createElement('script');\r\n        script.src = 'https://apis.google.com/js/api.js';\r\n\r\n        script.onload = resolve;\r\n        script.onerror = reject;\r\n\r\n        document.body.appendChild(script);\r\n      });\r\n    } catch (error) {\r\n      console.error('Google API 스크립트 로드 실패:', error);\r\n    }\r\n  };\r\n\r\n  loadGoogleApiScript();\r\n}, []);\r\n\r\n\r\n\r\n {/*  구글 로그인 처리 함수 */}\r\n const handleGoogleLogin = async () => {\r\n  try {\r\n    if (!gapi.auth2) {\r\n      // 구글 API 스크립트 로드를 기다리기 위해 promise를 사용\r\n      await new Promise((resolve) => {\r\n        gapi.load('auth2', resolve);\r\n      });\r\n    }\r\n\r\n    // 'gapi.auth2'가 초기화되지 않았다면 초기화\r\n    if (!gapi.auth2.getAuthInstance()) {\r\n      gapi.auth2.init({\r\n        client_id: config.googleClientId,\r\n        cookie_policy: 'single_host_origin',\r\n        scope : 'profile email'\r\n      });\r\n    }\r\n\r\n    const auth2 = gapi.auth2.getAuthInstance();\r\n    const googleUser = await auth2.signIn();\r\n    const googleAccessToken = googleUser.getAuthResponse().access_token;\r\n    console.log('Google Access Token:', googleAccessToken);\r\n    const googleLoginData = await googleUserInfo(googleAccessToken)\r\n\r\n\r\n    // 스프링 백엔드와 통신하여 처리\r\n    const res = await googleSocialLogin(googleLoginData); // 스프링 백엔드의 구글 로그인 API 엔드포인트로 대체\r\n    console.log('Google 로그인 결과:', res);\r\n\r\n    if (res === 1) {\r\n      document.cookie = serialize('userId', googleLoginData.id, { path: '/' }); \r\n      document.cookie = serialize('userEmail', googleLoginData.email, { path: '/' }); \r\n      document.cookie = serialize('userName', googleLoginData.name, { path: '/' }); \r\n      document.cookie = serialize('userProfileImage', googleLoginData.picture, { path: '/' });\r\n      navigate('/main');\r\n      const userName = getCookie('userName') \r\n      enqueueSnackbar(`${userName}님, 어서오세요.`, { variant: 'success' });\r\n      setAlertOn(true)      \r\n    } else {\r\n      console.log('Google 로그인 실패');\r\n      enqueueSnackbar('로그인에 실패했습니다.', { variant: 'warning' });\r\n      setAlertOn(true);\r\n    }\r\n  } catch (error) {\r\n    console.error('Google 로그인 에러:', error);\r\n    enqueueSnackbar('네트워크 오류 발생!', { variant: 'error' });\r\n    setAlertOn(true);\r\n  }\r\n};\r\n\r\n\r\n\r\n  return (\r\n    <>\r\n        <div style={{ textAlign: 'center' }}>\r\n          <img\r\n          src=\"/images/logo/googlebtn2.png\"\r\n          alt=\"구글 로그인\"\r\n          style={{ width: '220px', height: '50px', cursor: 'pointer' }}\r\n          onClick={handleGoogleLogin}\r\n        />\r\n            </div>\r\n            <Snackbar open={alertOn} autoHideDuration={3000} onClose={handleClose}>\r\n          <Alert onClose={handleClose} severity=\"success\" sx={{ width: '100%' }}>\r\n            로그인에 성공했습니다!\r\n          </Alert>\r\n        </Snackbar>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default GoogleLogin"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}