{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/carax/Desktop/SideProject/reactfront/front/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/carax/Desktop/SideProject/reactfront/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/carax/Desktop/SideProject/reactfront/front/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import config from\"../../config\";import{serialize}from\"cookie\";import{useNavigate}from\"react-router\";import{naverSocialLogin}from\"../../axios/user/loginLogic\";import{useSnackbar}from\"notistack\";import{Alert,Snackbar}from\"@mui/material\";import{getCookie}from\"../../utils/getCookies\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NaverLogin=function NaverLogin(){var navigate=useNavigate();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),alertOn=_useState2[0],setAlertOn=_useState2[1];var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var handleClose=function handleClose(){setAlertOn(false);};var userAccessToken=function userAccessToken(){window.location.href.includes('access_token')&&getToken();};var getToken=function getToken(){var token=window.location.href.split('=')[1].split('&')[0];console.log(token);document.cookie=serialize(\"naverToken\",token,{path:'/'});};var initializeNaverLogin=function initializeNaverLogin(){var naverLogin=new window.naver.LoginWithNaverId({clientId:config.naverClientId,callbackUrl:config.naverRedirectUri,clientSecret:config.naverClientSecret,isPopup:false,loginButton:{color:\"green\",type:3,height:\"46\"}});naverLogin.init();naverLogin.getLoginStatus(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(status){var _naverLogin$user,id,name,email,birthday,profile_image,naverLoginData,res,userName;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!status){_context.next=9;break;}_naverLogin$user=naverLogin.user,id=_naverLogin$user.id,name=_naverLogin$user.name,email=_naverLogin$user.email,birthday=_naverLogin$user.birthday,profile_image=_naverLogin$user.profile_image;naverLoginData={id:id,name:name,email:email,birthday:birthday,profile_image:profile_image};_context.next=5;return naverSocialLogin(naverLoginData);case 5:res=_context.sent;if(res===1){console.log(\"네이버 로그인 성공!\");console.log(\"프로필 이미지 URL:\",profile_image);userAccessToken();document.cookie=serialize(\"userId\",id,{path:'/'});document.cookie=serialize(\"userName\",name,{path:'/'});document.cookie=serialize(\"userEmail\",email,{path:'/'});document.cookie=serialize(\"userBirth\",birthday,{path:'/'});document.cookie=serialize(\"userProfileImage\",profile_image,{path:'/'});navigate('/main');userName=getCookie('userName');enqueueSnackbar(\"\".concat(userName,\"\\uB2D8, \\uC5B4\\uC11C\\uC624\\uC138\\uC694.\"),{variant:'success'});setAlertOn(true);}else{console.log(\"Naver 로그인 실패\");enqueueSnackbar('로그인에 실패했습니다.',{variant:'warning'});setAlertOn(true);}_context.next=9;break;case 9:case\"end\":return _context.stop();}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}());};useEffect(function(){var script=document.createElement(\"script\");script.src=\"https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.2.js\";script.charset=\"utf-8\";script.onload=function(){return initializeNaverLogin();};document.body.appendChild(script);return function(){document.body.removeChild(script);};},[]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{id:\"naverIdLogin\",style:{textAlign:\"center\"}}),/*#__PURE__*/_jsx(Snackbar,{open:alertOn,autoHideDuration:3000,onClose:handleClose,children:/*#__PURE__*/_jsx(Alert,{onClose:handleClose,severity:\"success\",sx:{width:'100%'},children:\"\\uB85C\\uADF8\\uC778\\uC5D0 \\uC131\\uACF5\\uD588\\uC2B5\\uB2C8\\uB2E4!\"})})]});};export default NaverLogin;","map":{"version":3,"names":["React","useEffect","useState","config","serialize","useNavigate","naverSocialLogin","useSnackbar","Alert","Snackbar","getCookie","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","NaverLogin","navigate","_useState","_useState2","_slicedToArray","alertOn","setAlertOn","_useSnackbar","enqueueSnackbar","handleClose","userAccessToken","window","location","href","includes","getToken","token","split","console","log","document","cookie","path","initializeNaverLogin","naverLogin","naver","LoginWithNaverId","clientId","naverClientId","callbackUrl","naverRedirectUri","clientSecret","naverClientSecret","isPopup","loginButton","color","type","height","init","getLoginStatus","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","status","_naverLogin$user","id","name","email","birthday","profile_image","naverLoginData","res","userName","wrap","_callee$","_context","prev","next","user","sent","concat","variant","stop","_x","apply","arguments","script","createElement","src","charset","onload","body","appendChild","removeChild","children","style","textAlign","open","autoHideDuration","onClose","severity","sx","width"],"sources":["C:/Users/carax/Desktop/SideProject/reactfront/front/src/pages/user/NaverLogin.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport config from \"../../config\";\r\nimport { serialize } from \"cookie\";\r\nimport { useNavigate } from \"react-router\";\r\nimport { naverSocialLogin } from \"../../axios/user/loginLogic\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport { Alert, Snackbar } from \"@mui/material\";\r\nimport { getCookie } from \"../../utils/getCookies\";\r\n\r\nconst NaverLogin = () => {\r\n  const navigate = useNavigate();\r\n  const [alertOn, setAlertOn] = useState(false);\r\n  const { enqueueSnackbar } = useSnackbar(); \r\n  \r\n  const handleClose = () => {\r\n    setAlertOn(false)\r\n  }\r\n\r\n\r\n  const userAccessToken = () => {\r\n    window.location.href.includes('access_token') && getToken();\r\n  };\r\n\r\n  const getToken = () => {\r\n    const token = window.location.href.split('=')[1].split('&')[0];\r\n    console.log(token);\r\n    document.cookie = serialize(\"naverToken\", token, { path: '/' });\r\n   \r\n  };\r\n\r\n  \r\n  const initializeNaverLogin = () => {\r\n    const naverLogin = new window.naver.LoginWithNaverId({\r\n      clientId: config.naverClientId,\r\n      callbackUrl: config.naverRedirectUri,\r\n      clientSecret: config.naverClientSecret,\r\n      isPopup: false,\r\n      loginButton: { color: \"green\", type: 3, height: \"46\" },\r\n    });\r\n\r\n    naverLogin.init();\r\n\r\n    naverLogin.getLoginStatus(async function (status) {\r\n      if (status) {\r\n        const { id, name, email, birthday, profile_image } = naverLogin.user;\r\n\r\n        const naverLoginData = {\r\n          id,\r\n          name,\r\n          email,\r\n          birthday,\r\n          profile_image,\r\n        };\r\n\r\n        const res = await naverSocialLogin(naverLoginData);\r\n        if (res === 1) {\r\n          console.log(\"네이버 로그인 성공!\");\r\n          console.log(\"프로필 이미지 URL:\", profile_image);\r\n\r\n          userAccessToken();\r\n          document.cookie = serialize(\"userId\", id, { path: '/' });\r\n          document.cookie = serialize(\"userName\", name, { path: '/' });\r\n          document.cookie = serialize(\"userEmail\", email, { path: '/' });\r\n          document.cookie = serialize(\"userBirth\", birthday, { path: '/' });\r\n          document.cookie = serialize(\"userProfileImage\", profile_image, { path: '/' });\r\n          navigate('/main')\r\n          const userName = getCookie('userName')\r\n          enqueueSnackbar(`${userName}님, 어서오세요.`, { variant: 'success' });\r\n          setAlertOn(true);\r\n        } else {\r\n          console.log(\"Naver 로그인 실패\");\r\n          enqueueSnackbar('로그인에 실패했습니다.', { variant: 'warning' });\r\n          setAlertOn(true);\r\n        }\r\n      } else {\r\n      }\r\n    });\r\n  };\r\n\r\n\r\n\r\n  useEffect(() => {\r\n    const script = document.createElement(\"script\");\r\n    script.src = \"https://static.nid.naver.com/js/naveridlogin_js_sdk_2.0.2.js\";\r\n    script.charset = \"utf-8\";\r\n    script.onload = () => initializeNaverLogin();\r\n    document.body.appendChild(script);\r\n    return () => {\r\n      document.body.removeChild(script);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n  <>\r\n    <div id=\"naverIdLogin\" style={{ textAlign: \"center\" }}>\r\n    </div>\r\n    <Snackbar open={alertOn} autoHideDuration={3000} onClose={handleClose}>\r\n          <Alert onClose={handleClose} severity=\"success\" sx={{ width: '100%' }}>\r\n            로그인에 성공했습니다!\r\n          </Alert>\r\n        </Snackbar>\r\n  </>\r\n  );\r\n};\r\n\r\nexport default NaverLogin;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}